# NovelVoice é…ç½®æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•ä½¿ç”¨ `config.yml` é…ç½®æ–‡ä»¶è‡ªå®šä¹‰ NovelVoice çš„è¿è¡Œå‚æ•°ã€‚

## å¿«é€Ÿå¼€å§‹

1. **å¤åˆ¶ç¤ºä¾‹é…ç½®**
   ```bash
   cp data/config/config.example.yml data/config/config.yml
   ```

2. **ç¼–è¾‘é…ç½®æ–‡ä»¶**
   ```bash
   nano data/config/config.yml  # æˆ–ä½¿ç”¨æ‚¨å–œæ¬¢çš„ç¼–è¾‘å™¨
   ```

3. **åº”ç”¨é…ç½®**
   
   **æ–¹å¼ä¸€: çƒ­é‡è½½ (æ¨è)** - æ— éœ€é‡å¯æœåŠ¡
   - åœ¨ Web ç•Œé¢ç‚¹å‡»"é‡è½½é…ç½®"æŒ‰é’®(ä½äºé…éŸ³è®¾ç½®æ ‡é¢˜æ )
   - é…ç½®ç«‹å³ç”Ÿæ•ˆ,æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¸å—å½±å“
   
   **æ–¹å¼äºŒ: é‡å¯æœåŠ¡**
   ```bash
   # é‡å¯åº”ç”¨
   python -m uvicorn app.main:app --host 0.0.0.0 --port 8000
   
   # æˆ–é‡å¯ Docker å®¹å™¨
   docker-compose restart
   ```

## é…ç½®çƒ­é‡è½½

NovelVoice æ”¯æŒé…ç½®çƒ­é‡è½½åŠŸèƒ½,ä¿®æ”¹é…ç½®æ–‡ä»¶åæ— éœ€é‡å¯æœåŠ¡å³å¯åº”ç”¨æ–°é…ç½®ã€‚

### ä½¿ç”¨æ–¹æ³•

1. ç¼–è¾‘ `data/config/config.yml` æ–‡ä»¶
2. ä¿å­˜ä¿®æ”¹
3. åœ¨ Web ç•Œé¢ç‚¹å‡»"é‡è½½é…ç½®"æŒ‰é’®
4. æŸ¥çœ‹æç¤ºä¿¡æ¯ç¡®è®¤é‡è½½æˆåŠŸ

### ç‰¹æ€§

- âœ… **é›¶åœæœºæ›´æ–°** - æ— éœ€é‡å¯æœåŠ¡
- âœ… **æ ¼å¼éªŒè¯** - YAML æ ¼å¼é”™è¯¯æ—¶ä¿ç•™åŸé…ç½®
- âœ… **ä»»åŠ¡éš”ç¦»** - æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ä¸å—å½±å“
- âœ… **å³æ—¶ç”Ÿæ•ˆ** - æ–°ä»»åŠ¡ç«‹å³ä½¿ç”¨æœ€æ–°é…ç½®
- âœ… **é”™è¯¯æç¤º** - æ¸…æ™°çš„æˆåŠŸ/å¤±è´¥åé¦ˆ

### æ³¨æ„äº‹é¡¹

> âš ï¸ **é‡è¦**: é…ç½®é‡è½½ä¸ä¼šå½±å“æ­£åœ¨è¿è¡Œçš„ TTS ä»»åŠ¡,åªå¯¹æ–°å¯åŠ¨çš„ä»»åŠ¡ç”Ÿæ•ˆã€‚

> ğŸ’¡ **æç¤º**: å¦‚æœé…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯(å¦‚ YAML è¯­æ³•é”™è¯¯),ç³»ç»Ÿä¼šä¿ç•™åŸé…ç½®å¹¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯,ä¸ä¼šä¸­æ–­æœåŠ¡ã€‚

## é…ç½®ä¼˜å…ˆçº§

é…ç½®å€¼çš„åŠ è½½ä¼˜å…ˆçº§(ä»é«˜åˆ°ä½):

1. **ç¯å¢ƒå˜é‡** - å¦‚ `export TTS_DEFAULT_VOICE=zh-CN-YunxiNeural`
2. **data/config/config.yml æ–‡ä»¶** - é…ç½®æ–‡ä»¶
3. **å†…ç½®é»˜è®¤å€¼** - ä»£ç ä¸­çš„é»˜è®¤é…ç½®

> ğŸ’¡ **æç¤º**: ç¯å¢ƒå˜é‡åç§°ä¸ºé…ç½®è·¯å¾„çš„å¤§å†™å½¢å¼,ç”¨ä¸‹åˆ’çº¿è¿æ¥ã€‚ä¾‹å¦‚ `tts.default_voice` â†’ `TTS_DEFAULT_VOICE`

## é…ç½®é¡¹è¯´æ˜

### æœåŠ¡å™¨é…ç½®

```yaml
server:
  host: "0.0.0.0"      # ç›‘å¬åœ°å€ (0.0.0.0 è¡¨ç¤ºæ‰€æœ‰ç½‘å¡)
  port: 8000           # ç›‘å¬ç«¯å£
  reload: false        # å¼€å‘æ¨¡å¼çƒ­é‡è½½ (ç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­)
```

### TTS é»˜è®¤å‚æ•°

```yaml
tts:
  default_voice: "zh-CN-XiaoxiaoNeural"  # é»˜è®¤å‘éŸ³äºº
  default_rate: "+0%"                     # é»˜è®¤è¯­é€Ÿ (-50% åˆ° +100%)
  default_volume: "+0%"                   # é»˜è®¤éŸ³é‡ (-50% åˆ° +50%)
  default_pitch: "+0Hz"                   # é»˜è®¤éŸ³è°ƒ (-50Hz åˆ° +50Hz)
  max_chars: 8000                         # å•æ¬¡åˆæˆæœ€å¤§å­—ç¬¦æ•°
  concurrency_limit: 2                    # åŒæ—¶å¤„ç†çš„ç« èŠ‚æ•° (å»ºè®® 1-5)
  max_retries: 3                          # å¤±è´¥é‡è¯•æ¬¡æ•°
  timeout: 30                             # å•æ¬¡åˆæˆè¶…æ—¶æ—¶é—´ (ç§’)
```

**å‚æ•°è°ƒä¼˜å»ºè®®**:
- **è¯­é€Ÿ**: å¬ä¹¦å»ºè®® `+10%` åˆ° `+30%`
- **å¹¶å‘é™åˆ¶**: 
  - ç½‘ç»œè¾ƒæ…¢: `1-2`
  - ç½‘ç»œæ­£å¸¸: `2-3`
  - ç½‘ç»œå¿«é€Ÿ: `3-5`
- **è¶…æ—¶æ—¶é—´**: ç½‘ç»œä¸ç¨³å®šæ—¶å¯å¢åŠ åˆ° `60` ç§’

### æ–‡æœ¬å¤„ç†é…ç½®

```yaml
text_processing:
  chapter_pattern: "^\\s*ç¬¬.{1,7}[ç« èŠ‚å›].*"  # ç« èŠ‚è¯†åˆ«æ­£åˆ™
  chunk_size: 5000                            # å®šé•¿åˆ†ç« å¤§å°
  min_chunk_length: 50                        # æœ€å°æœ‰æ•ˆå†…å®¹é•¿åº¦
```

**ç« èŠ‚è¯†åˆ«**:
- é»˜è®¤æ­£åˆ™å¯è¯†åˆ«: "ç¬¬ä¸€ç« "ã€"ç¬¬1ç« "ã€"ç¬¬001ç« "ã€"ç¬¬ä¸€èŠ‚"ã€"ç¬¬ä¸€å›" ç­‰
- å¦‚éœ€è‡ªå®šä¹‰,è¯·ä¿®æ”¹ `chapter_pattern`

### è·¯å¾„é…ç½®

```yaml
paths:
  data_dir: "data"              # æ•°æ®æ ¹ç›®å½•
  app_data_dir: "data/app"      # åº”ç”¨æ•°æ®ç›®å½• (å­˜æ”¾ä¹¦ç±å’ŒéŸ³é¢‘)
  db_dir: "data/db"             # æ•°æ®åº“ç›®å½• (å­˜æ”¾ä»»åŠ¡è®°å½•) (v1.3.0+)
  cache_dir: "data/cache"       # ç¼“å­˜ç›®å½• (å­˜æ”¾é¢„è§ˆéŸ³é¢‘)
```

**è·¯å¾„è¯´æ˜**:
- æ”¯æŒç›¸å¯¹è·¯å¾„(ç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•)å’Œç»å¯¹è·¯å¾„
- ç›®å½•ä¸å­˜åœ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»º

### Bark é€šçŸ¥é…ç½®

```yaml
bark:
  enabled: false                          # æ˜¯å¦å¯ç”¨ Bark æ¨é€
  server_url: "https://api.day.app"       # Bark æœåŠ¡å™¨åœ°å€
  api_key: ""                             # Bark API Key
  web_base_url: "http://localhost:8000"   # Web ç•Œé¢åœ°å€
```

**å¯ç”¨ Bark æ¨é€**:
1. åœ¨ iOS è®¾å¤‡å®‰è£… Bark App
2. è·å–æ‚¨çš„ API Key
3. ä¿®æ”¹é…ç½®:
   ```yaml
   bark:
     enabled: true
     api_key: "your_bark_key_here"
     web_base_url: "http://your_server_ip:8000"
   ```

### å¯ç”¨è¯­éŸ³åˆ—è¡¨

NovelVoice æ”¯æŒ **31 ç§é«˜è´¨é‡è¯­éŸ³**,æ¶µç›–:
- ğŸ‡¨ğŸ‡³ ä¸­å›½å¤§é™†(æ™®é€šè¯): 6ä¸ª
- ğŸ—£ï¸ ä¸­å›½æ–¹è¨€(è¾½å®ã€é™•è¥¿): 2ä¸ª
- ğŸ‡­ğŸ‡° ä¸­å›½é¦™æ¸¯(ç²¤è¯­): 3ä¸ª
- ğŸ‡¹ğŸ‡¼ ä¸­å›½å°æ¹¾(å°æ¹¾å›½è¯­): 3ä¸ª
- ğŸ‡ºğŸ‡¸ ç¾å›½(è‹±è¯­): 8ä¸ª
- ğŸ‡¬ğŸ‡§ è‹±å›½(è‹±è¯­): 5ä¸ª
- ğŸ‡¨ğŸ‡¦ åŠ æ‹¿å¤§(è‹±è¯­): 2ä¸ª
- ğŸ‡¯ğŸ‡µ æ—¥æœ¬(æ—¥è¯­): 2ä¸ª

**é…ç½®æ ¼å¼**:

```yaml
voices:
  # ä¸­å›½å¤§é™† (æ™®é€šè¯)
  - short_name: "zh-CN-XiaoxiaoNeural"
    locale: "zh-CN"
    language: "æ™®é€šè¯"
    region: "ä¸­å›½å¤§é™†"
    gender: "Female"
    gender_cn: "å¥³"
    style: "æ¸©æš–"
    name: "xiaoxiao"
    description: "[æ¸©æš–] æ™®é€šè¯ - ä¸­å›½å¤§é™† - å¥³ - xiaoxiao"
  
  # ä¸­å›½æ–¹è¨€
  - short_name: "zh-CN-liaoning-XiaobeiNeural"
    locale: "zh-CN-liaoning"
    language: "ä¸œåŒ—å®˜è¯"
    region: "ä¸­å›½è¾½å®"
    gender: "Female"
    gender_cn: "å¥³"
    style: "å¹½é»˜"
    name: "xiaobei"
    description: "[å¹½é»˜] ä¸œåŒ—å®˜è¯ - ä¸­å›½è¾½å® - å¥³ - xiaobei"
  
  # æ›´å¤šè¯­éŸ³è¯·æŸ¥çœ‹ data/config/config.example.yml
```

**æŸ¥çœ‹å®Œæ•´åˆ—è¡¨**:
å®Œæ•´çš„ 31 ä¸ªè¯­éŸ³é…ç½®è¯·æŸ¥çœ‹ `data/config/config.example.yml` æ–‡ä»¶ã€‚

**æ·»åŠ è‡ªå®šä¹‰è¯­éŸ³**:
1. è®¿é—® [Microsoft Edge TTS è¯­éŸ³åˆ—è¡¨](https://speech.microsoft.com/portal/voicegallery)
2. é€‰æ‹©è¯­éŸ³å¹¶å¤åˆ¶ `ShortName`
3. æŒ‰ç…§ä¸Šè¿°æ ¼å¼æ·»åŠ åˆ°é…ç½®æ–‡ä»¶

### æ—¥å¿—é…ç½®

```yaml
logging:
  level: "INFO"                 # æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR
  max_logs: 200                 # å†…å­˜ä¸­ä¿ç•™çš„æœ€å¤§æ—¥å¿—æ¡æ•°
  max_bytes: 10485760           # å•ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å° (10MB)
  backup_count: 5               # ä¿ç•™å†å²æ—¥å¿—æ–‡ä»¶æ•°
  error_log_file: "error.log"   # é”™è¯¯æ—¥å¿—æ–‡ä»¶å
```

## ç¯å¢ƒå˜é‡ç¤ºä¾‹

åœ¨ Docker æˆ–ç³»ç»Ÿç¯å¢ƒä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡:

```bash
# ä¿®æ”¹é»˜è®¤è¯­éŸ³
export TTS_DEFAULT_VOICE=zh-CN-YunxiNeural

# ä¿®æ”¹æœåŠ¡å™¨ç«¯å£
export SERVER_PORT=9000

# å¯ç”¨ Bark é€šçŸ¥
export BARK_ENABLED=true
export BARK_API_KEY=your_key_here

# å¯åŠ¨åº”ç”¨
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000
```

## å¸¸è§é—®é¢˜

### Q: ä¿®æ”¹é…ç½®åä¸ç”Ÿæ•ˆ?
A: éœ€è¦é‡å¯åº”ç”¨æ‰èƒ½åŠ è½½æ–°é…ç½®ã€‚

### Q: é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ä¼šæ€æ ·?
A: åº”ç”¨ä¼šä½¿ç”¨å†…ç½®é»˜è®¤é…ç½®å¹¶æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯,ä¸å½±å“æ­£å¸¸è¿è¡Œã€‚

### Q: å¦‚ä½•æ¢å¤é»˜è®¤é…ç½®?
A: åˆ é™¤æˆ–é‡å‘½å `data/config/config.yml`,æˆ–ä» `data/config/config.example.yml` å¤åˆ¶ã€‚

### Q: ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶å†²çª?
A: ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§æ›´é«˜,ä¼šè¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„å€¼ã€‚

## é…ç½®ç¤ºä¾‹

### ç¤ºä¾‹ 1: å¿«é€Ÿå¬ä¹¦é…ç½®
```yaml
tts:
  default_voice: "zh-CN-YunxiNeural"  # ç”·å£°
  default_rate: "+30%"                 # åŠ å¿«è¯­é€Ÿ
  concurrency_limit: 3                 # æé«˜å¹¶å‘
```

### ç¤ºä¾‹ 2: é«˜è´¨é‡æ…¢é€Ÿé…ç½®
```yaml
tts:
  default_voice: "zh-CN-XiaoxiaoNeural"  # å¥³å£°
  default_rate: "-10%"                    # æ”¾æ…¢è¯­é€Ÿ
  default_volume: "+10%"                  # å¢å¤§éŸ³é‡
  concurrency_limit: 1                    # é™ä½å¹¶å‘ä¿è¯è´¨é‡
```

### ç¤ºä¾‹ 3: æœåŠ¡å™¨éƒ¨ç½²é…ç½®
```yaml
server:
  host: "0.0.0.0"
  port: 80
  reload: false

bark:
  enabled: true
  api_key: "your_production_key"
  web_base_url: "https://your-domain.com"
```
